<!doctype html><html data-reactid=".1bsoigh6xhc" data-react-checksum="-314581424"><head data-reactid=".1bsoigh6xhc.0"><meta charset="utf-8" data-reactid=".1bsoigh6xhc.0.0"><title data-reactid=".1bsoigh6xhc.0.1">DžejEs - JavaScript pro web</title><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" data-reactid=".1bsoigh6xhc.0.2"><link rel="stylesheet" type="text/css" href="main-73051c71144d61d48eff.css?v=1.0.0" data-reactid=".1bsoigh6xhc.0.3"><link rel="icon" type="image/png" href="images/favicon-4b52c7e9cc28fdb9378fd1542994a946.png" data-reactid=".1bsoigh6xhc.0.4"><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" data-reactid=".1bsoigh6xhc.0.5"><link rel="canonical" href="https://www.dzejes.cz/prvni-dev-stack.html" data-reactid=".1bsoigh6xhc.0.6"><base target="_blank" data-reactid=".1bsoigh6xhc.0.7"></head><body data-reactid=".1bsoigh6xhc.1"><div data-reactid=".1bsoigh6xhc.1.0"><header class="Header" data-reactid=".1bsoigh6xhc.1.0.0"><div class="NavBar" data-reactid=".1bsoigh6xhc.1.0.0.0"><div class="NavBar-container" data-reactid=".1bsoigh6xhc.1.0.0.0.0"><div class="NavBar-item" data-reactid=".1bsoigh6xhc.1.0.0.0.0.0"><a class="NavBar-link" href="/" target="_self" data-reactid=".1bsoigh6xhc.1.0.0.0.0.0.0">Úvod</a><a class="NavBar-link" href="https://twitter.com/vmiksu" data-reactid=".1bsoigh6xhc.1.0.0.0.0.0.1">Twitter</a><a class="NavBar-link" href="https://github.com/tajo/javascript" data-reactid=".1bsoigh6xhc.1.0.0.0.0.0.2">GitHub</a><a class="NavBar-link" href="/feed.xml" data-reactid=".1bsoigh6xhc.1.0.0.0.0.0.3">RSS</a></div></div></div></header><div class="PageBody" data-reactid=".1bsoigh6xhc.1.0.1"><div class="PageBody-container" data-reactid=".1bsoigh6xhc.1.0.1.0"><div style="width:100%;" data-reactid=".1bsoigh6xhc.1.0.1.0.0"><div style="width:100%;" data-reactid=".1bsoigh6xhc.1.0.1.0.0.$0"><h1>První dev stack<a id="prvn-dev-stack">&nbsp;</a></h1><p>Hlavním hrdinou dnešního článku se stane bundlovací nástroj webpack. Lecos jste se o něm mohli dozvědět už v <a href="nastroje.html">minulém článku</a>. S jeho pomocí postavíme první jednoduchou &quot;Hello world&quot; aplikaci v Reactu, která bude například používat Babel (JavaScript budoucnosti) a LESS (CSS preprocesor). <strong>Ukážeme si sílu moderních JS nástrojů v praxi</strong>.</p>
<h2>Výsledek<a id="v-sledek">&nbsp;</a></h2><p>Protože určitě nemáte rádi překvapení, tak vám hned v úvodu ukážu k čemu se na konci tohoto článku dopracujeme. Výsledkem bude triviální 100% JavaScriptová aplikace s jedinou React komponentou. Jakékoliv úpravy v ní, či přiloženém LESSu se po uložení v editoru <strong>okamžitě</strong> projeví na stránce. <strong>Bez refreshnutí, prosím pěkně!</strong> Kompletní zdrojové kódy najdete v <a href="https://github.com/tajo/devstack">samostatném repozitáři na GitHubu</a>.</p>
<p class="pic-container" style="max-width:630px">
  <img src="images/result-5370fc7a6c97226444ceab4826ac0feb.gif" class="pic" title="Hot reloading v praxi" />
</p>


<h2>Očekávání<a id="o-ek-v-n-">&nbsp;</a></h2><p>Doufám, že se vám demo líbilo. Na první pohled se možná nezdá jako kdoví co, ale vězte, že pod jeho pokličkou toho bublá daleko více. Běží totiž na moderním JS dev stacku, což je soubor různých knihoven, technik a nastavení. Je to základová deska pro náš rodinný baráček. Avšak s menší úpravou by zvládla unést i velký hrad. Co tedy od ní čekat? Jaké jsou naše požadavky?</p>
<p><strong>Chceme:</strong></p>
<ul>
<li><strong>programovat v Babelu</strong>, protože <a href="babel.html">je to lepší JavaScript</a></li>
<li>budovat velkou a škálovatelnou aplikaci → <strong>chceme maximální modularitu</strong></li>
<li>mít možnost jednoduše integrovat a <strong>používat stovky tisíce balíčků z npm</strong></li>
<li>používat nějaký šikovný <strong>CSS preprocesor</strong>, třeba LESS, do budoucna pak možná <a href="http://www.zdrojak.cz/clanky/smeruje-css-od-preprocesingu-k-postprocesingu/">postprocesor</a></li>
<li>po každé změně v JS i CSS <strong>ihned vidět výsledek v prohlížeči</strong>, ideálně bez refreshnutí</li>
<li>mít <strong>2 módy</strong>: vývojový a produkční</li>
<li>v produkčním módu všechny potřebné JS soubory (moduly) <strong>sloučit do jednoho a minimalizovat</strong>, obdobně i pro kaskádové styly</li>
<li>v produkčním módu ignorovat warningy a jiné debugovací výpisy</li>
<li>mít <strong>kód kontrolovaný linterem</strong>, aby zůstal pěkný a jednotný</li>
<li>aby po prvotním nastavení <strong>všechno fungovalo automaticky</strong></li>
<li><strong>jednoduchost!</strong></li>
</ul>
<p>Dlouhý a náročný seznam? Ale kdeže. Jsme programátoři, náš čas je extrémně drahý a menší investice do ladění vývojářského procesu se nám mnohonásobně vrátí. Navíc to sfoukneme raz dva!</p>
<p class="pic-container" style="max-width:534px">
  <img src="images/wheels-19392e4a50c18fa6ced9e98a3dc76efe.png" class="pic" title="Nemáte čas na zlepšování?" />
</p>

<p>Stack pro tento článek jsem si samozřejmě nevycucal z prstu, ale inspiroval se z mnoha jiných. Mým cílem bylo postavit něco, co bude maximálně jednoduché a přesto použitelné pro reálnou aplikaci. Neobsahuje například React-router, Redux či Immutable.js. Jsou to výborné knihovny a vřele doporučuji je prozkoumat, ale pro začátek nejsou potřeba. Řeší totiž problémy, které vyvstávají až u velkých aplikací. Pokud přesto máte chuť a odvahu jít do toho &quot;all-in&quot;, zkuste například <a href="https://github.com/este/este">github.com/este/este</a>.</p>
<h2>Webpack<a id="webpack">&nbsp;</a></h2><p>Už jsem o něm básnil v <a href="nastroje.html">předchozím článku</a>. Pro jeho docenění je nejdříve potřeba pojmenovat zásadní problém, kterému vývojáři webových aplikací čelí. Naše aplikace (zdrojové kódy) jsou distribuovány pomocí pomalého a nespolehlivého protokolu HTTP do vzdáleného prohlížeče. Tam se musí ihned zparsovat, spustit a něco provést. Velikost naší aplikace je tedy velmi limitovaná, pokud nechceme uživatele ztratit nekonečnou bílou stránkou. <strong>Aby vše fungovalo svižně, musíme co nejvíce omezit počet HTTP requestů a minimalizovat jejich velikost.</strong></p>
<p class="pic-container" style="max-width:334px">
  <img src="images/webpack-0714810ae3fb211173e2964249507195.png" class="pic" title="Webpack" />
</p>

<p>Jinými slovy <strong>musíme velmi pečlivě zvážit, co a kdy do prohlížeče posílat a po jakých částech</strong>. U spousty aplikací nám bude stačit to, když všechny naše skripty spojíme do jednoho souboru <code>bundle.js</code>. Ovšem takový soubor může časem nepřijemně nabobtnat. Jak to vyřešit? Každá část (stránka) naší aplikace potřebuje pravděpodobně různé skripty a tak můžeme dle URL adresy posílat speciální menší bundly, kde bude jen to, co daná stránka skutečně potřebuje. Kód, který používají všechny stránky (typicky knihovna jako jQuery či React), pak dáme do  <code>&lt;script src=&quot;common.js&quot;&gt;</code>, který bude všude - využijeme tak cache prohlížeče. <strong>To samé můžeme udělat s CSS</strong>. Obrázky pak můžeme vhodně cacheovat (verzovat) a ty, které mají jen pár kB, rovnou vložit zakódované do HTML jako base64 - ušetříme tak další drahocenné requesty. <strong>To zní jako hodně otravné práce, že?</strong></p>
<p>Ano, to je hodně práce! Naštěstí existuje geniální webpack, který tohle vše dokáže vyřešit za nás. Jediné co musíme udělat my je <strong>explicitní uvádění závislostí</strong>. V hantýrce ES6 jde o <code>import</code>, v ES5 pak o <code>require</code>. U našich JS modulů to dělat musíme tak jako tak, ale ta převratná myšlenka webpacku spočívá v tom, že úplně stejným způsobem <strong>budeme uvádět (importovat) i CSS, obrázky, fonty</strong> a vlastně úplně cokoliv co daná stránka / komponenta / balíček potřebuje ke svému životu.</p>
<p>Webpack pak projde všechny soubory (importy) a sestaví komplexní graf závislostí. Ještě mu musíme ukázat, kde začít, co ignorovat, čím jednotlivé formáty zpracovat (loadery) a jaký od něho očekáváme výstup (jeden velký bundle, více menších bundlů ...). <strong>Výstup pak bude 100% optimální</strong>. Každá část aplikace dostane &quot;na cestu&quot; jen to co skutečně potřebuje a nic zbytečně navíc. Hurá!</p>
<p><strong>Webpack má obsáhlou <a href="http://webpack.github.io/docs/">dokumentaci</a></strong>, která je ale trochu nepřehledná. Můžete také nahlédnout do <a href="https://github.com/petehunt/webpack-howto">hezkého shrnutí</a> od Pete Hunta. Webpack je velký a mocný nástroj, který je zároveň i extrémně modulární díky loaderům a pluginům. <strong>Není však úplně snadné ho nastavit</strong>.</p>
<h2>Hot module replacement<a id="hot-module-replacement">&nbsp;</a></h2><p>V roce 2015 měl velkou slávu hot reloading. Jde o další skvělou funkci webpacku (dnes už je i nějaká podpora v browserify). Slouží čistě vývojářům během vývoje aplikace. <strong>Je to cesta, kterou je možné vyměňovat, přidávat a mazat moduly již v běžící aplikaci. Změny se pak na stránce projeví okamžitě bez refreshe.</strong></p>
<p>Proč je to tak převratné? <strong>Ohromně to zrychluje a zpříjemňuje vývoj</strong>. Refresh je nejen pomalý ale hlavně se při něm ztrácí stav aplikace. Například rozepsaný formulář nebo posloupnost kroků, kterou jste se dostali do nějaké skryté části aplikace (nedostupné přes URL).</p>
<p>Jak tahle magie funguje? Webpack-dev-server si pomocí socketů povídá s webpack runtime (přiložený bundle k hlavnímu skriptu stránky) a oznámí mu, když uložíte (aktualizujete) nějaký soubor. <strong>Webpack runtime se pak zeptá původního starého modulu, jestli umí zpracovat aktualizaci</strong>, pokud ne, tak jde tato výzva stromem závislostí výše. Pokud se nenajde nikdo, kdo by aktualizaci dokázal provést, tak vám webpack v konzoli suše oznámí, že je potřeba udělat klasický refresh. Musíme psát ke každému modulu potenciálně velmi komplikovanou accept metodu?</p>
<p>Ano i ne. <strong>U React komponent je potřeba vždy přerenderovat celý strom</strong>. Obecným dobrým trendem je udržovat stav aplikace mimo React komponenty (Redux) a tudíž tento postup funguje. Komponenty sice vždycky kompletně přerenderujeme, ale jelikož v nich není žádný stav, na stránce se vlastně nic nezmění (neztratí). Ovšem ne každý používá striktně Redux a tak vzniklo magické řešení plné hacků aka React Hot Loader, které se snaží stav v komponentách během přerenderování udržet, což ne vždy funguje. Pokud vás zajímá více detailů, přečtěte si <a href="https://medium.com/@dan_abramov/hot-reloading-in-react-1140438583bf#.90dg96b0m">výborný článek</a> od autora React Hot Loaderu Dana Abramova. <strong>TLDR;</strong> pokud budete používat Redux, tak žádné hacky vůbec nepotřebujete, jinak si počkejte na RHL v3, který je sice pořád komplexní, ale už ne tolik magický a více funkční.</p>
<h2>Struktura aplikace<a id="struktura-aplikace">&nbsp;</a></h2><code class="codeBlock">devstack<span class="token operator" >/</span>                        ← hlavní adresář
  ├── build<span class="token operator" >/</span>                     ← produkční <span class="token punctuation" >(</span>vybuildněná<span class="token punctuation" >)</span> verze
  ├── node_modules<span class="token operator" >/</span>              ← NPM balíčky <span class="token punctuation" >(</span>závislosti projektu<span class="token punctuation" >)</span>
  ├── src<span class="token operator" >/</span>                       ← zdrojové kódy
  │   ├── client<span class="token operator" >/</span>                ← front<span class="token operator" >-</span>end <span class="token punctuation" >(</span>FE<span class="token punctuation" >)</span> <span class="token operator" >/</span> prohlížečová část
  │   │   └── hello<span class="token punctuation" >.</span>gif          ← velký obrázek <span class="token punctuation" >(</span><span class="token operator" >></span>10kB<span class="token punctuation" >)</span>
  │   │   └── icon<span class="token punctuation" >.</span>png           ← malý obrázek <span class="token punctuation" >(</span><span class="token operator" >&lt;</span>10kB<span class="token punctuation" >)</span>
  │   │   └── index<span class="token punctuation" >.</span>js           ← hlavní <span class="token punctuation" >(</span>vstupní<span class="token punctuation" >)</span> soubor FE části
  │   │   └── main<span class="token punctuation" >.</span>js            ← hlavní root <span class="token qualifier" >React</span> komponenta
  │   │   └── main<span class="token punctuation" >.</span>less          ← CSS styly pro hlavní komponentu
  │   ├── server<span class="token operator" >/</span>                ← serverová část <span class="token punctuation" >(</span>node<span class="token punctuation" >.</span>js<span class="token punctuation" >)</span>
  │   │   └── html<span class="token punctuation" >.</span>js            ← komponenta se strukturou HTML stránky
  │   │   └── index<span class="token punctuation" >.</span>js           ← babel require hook
  │   │   └── main<span class="token punctuation" >.</span>js            ← HTTP <span class="token punctuation" >(</span>express<span class="token punctuation" >)</span> server
  ├── webpack<span class="token operator" >/</span>                   ← nastavení webpacku
  │   └── config<span class="token punctuation" >.</span>dev<span class="token punctuation" >.</span>babel<span class="token punctuation" >.</span>js    ← webpack konfig pro vývojový režim
  │   └── config<span class="token punctuation" >.</span>prod<span class="token punctuation" >.</span>babel<span class="token punctuation" >.</span>js   ← webpack konfig pro produkční verzi
  │   └── constants<span class="token punctuation" >.</span>js           ← konstanty<span class="token punctuation" >,</span> cesty
  │   └── index<span class="token punctuation" >.</span>js               ← babel require hook
  │   └── server<span class="token punctuation" >.</span>dev<span class="token punctuation" >.</span>js          ← vývojový server webpacku
  ├── <span class="token punctuation" >.</span>babelrc                   ← konfigurace babelu <span class="token punctuation" >(</span>pro server<span class="token punctuation" >)</span>
  ├── <span class="token punctuation" >.</span>eslintrc                  ← konfigurace eslintu
  ├── <span class="token punctuation" >.</span>gitignore                 ← soubory ignorované gitem
  ├── <span class="token punctuation" >.</span>travis<span class="token punctuation" >.</span>yml                ← nastavení CI
  ├── LICENSE                    ← licence
  ├── README<span class="token punctuation" >.</span>md                  ← základní info <span class="token punctuation" >(</span>v angličtině<span class="token punctuation" >)</span>
  └── <span class="token keyword" >package</span><span class="token punctuation" >.</span>json               ← rodokomnen aplikace<span class="token punctuation" >,</span> závislosti atd<span class="token punctuation" >.</span></code><p>Obsah souboru <code>package.json</code>:</p>
<code class="codeBlock"><span class="token punctuation" >{</span>
  <span class="token string" >"name"</span><span class="token punctuation" >:</span> <span class="token string" >"devstack"</span><span class="token punctuation" >,</span>
  <span class="token string" >"description"</span><span class="token punctuation" >:</span> <span class="token string" >"Simple devstack for modern JS apps"</span><span class="token punctuation" >,</span>
  <span class="token string" >"author"</span><span class="token punctuation" >:</span> <span class="token string" >"Vojtech Miksu &lt;vojtech@miksu.cz>"</span><span class="token punctuation" >,</span>
  <span class="token string" >"version"</span><span class="token punctuation" >:</span> <span class="token string" >"1.0.0"</span><span class="token punctuation" >,</span>
  <span class="token string" >"private"</span><span class="token punctuation" >:</span> <span class="token primitive" >true</span><span class="token punctuation" >,</span>
  <span class="token string" >"scripts"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    <span class="token string" >"clean"</span><span class="token punctuation" >:</span> <span class="token string" >"rm -rf build"</span><span class="token punctuation" >,</span>
    <span class="token string" >"start"</span><span class="token punctuation" >:</span> <span class="token string" >"node webpack/index | NODE_ENV=development node src/server"</span><span class="token punctuation" >,</span>
    <span class="token string" >"build"</span><span class="token punctuation" >:</span> <span class="token string" >"npm run clean &amp;&amp; NODE_ENV=production webpack --config webpack/config.prod.babel.js"</span><span class="token punctuation" >,</span>
    <span class="token string" >"server"</span><span class="token punctuation" >:</span> <span class="token string" >"NODE_ENV=production node src/server"</span><span class="token punctuation" >,</span>
    <span class="token string" >"lint"</span><span class="token punctuation" >:</span> <span class="token string" >"eslint src webpack || true"</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token string" >"dependencies"</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    <span class="token string" >"babel-core"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.8.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-eslint"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.0.4"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.2.4"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-plugin-transform-runtime"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.8.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-preset-es2015"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.6.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-preset-node6"</span><span class="token punctuation" >:</span> <span class="token string" >"^11.0.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-preset-react"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.5.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-register"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.8.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"babel-runtime"</span><span class="token punctuation" >:</span> <span class="token string" >"^6.6.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"compression"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.6.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"css-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^0.23.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"eslint"</span><span class="token punctuation" >:</span> <span class="token string" >"^2.9.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"eslint-config-airbnb"</span><span class="token punctuation" >:</span> <span class="token string" >"^9.0.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"eslint-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.3.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"eslint-plugin-import"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.8.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"eslint-plugin-jsx-a11y"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.2.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"eslint-plugin-react"</span><span class="token punctuation" >:</span> <span class="token string" >"^5.1.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"express"</span><span class="token punctuation" >:</span> <span class="token string" >"^4.13.4"</span><span class="token punctuation" >,</span>
    <span class="token string" >"extract-text-webpack-plugin"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.0.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"file-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^0.8.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"ip"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.1.3"</span><span class="token punctuation" >,</span>
    <span class="token string" >"less"</span><span class="token punctuation" >:</span> <span class="token string" >"^2.5.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"less-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^2.0.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"react"</span><span class="token punctuation" >:</span> <span class="token string" >"^15.0.2"</span><span class="token punctuation" >,</span>
    <span class="token string" >"react-dom"</span><span class="token punctuation" >:</span> <span class="token string" >"^15.0.2"</span><span class="token punctuation" >,</span>
    <span class="token string" >"style-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^0.13.1"</span><span class="token punctuation" >,</span>
    <span class="token string" >"url-loader"</span><span class="token punctuation" >:</span> <span class="token string" >"^0.5.5"</span><span class="token punctuation" >,</span>
    <span class="token string" >"webpack"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.12.14"</span><span class="token punctuation" >,</span>
    <span class="token string" >"webpack-dev-middleware"</span><span class="token punctuation" >:</span> <span class="token string" >"^1.6.0"</span><span class="token punctuation" >,</span>
    <span class="token string" >"webpack-hot-middleware"</span><span class="token punctuation" >:</span> <span class="token string" >"^2.10.0"</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span></code><p>Po jeho uložení zavolejte:</p>
<code class="codeBlock">npm install</code><p>Všechny potřebné závislosti se vám tímto nainstalují do <code>node_modules/</code>.</p>
<h2>Server<a id="server">&nbsp;</a></h2><p>I přesto, že <strong>naše aplikace a veškerá její logika může kompletně běžet pouze v prohlížeči, pořád nám jí někdo musí do toho prohlížeče naservírovat</strong>. Potřebujeme server. Pro to úplně nejjednodušší použití potřebujeme od serveru to, aby nám vrátil základní HTML strukturu s prázdným <code>&lt;body /&gt;</code> a naší JS aplikací <code>&lt;script src=&quot;build/bundle.js&quot;&gt;</code>. Dále ještě potřebujeme, aby se ve vývojovém módu nahradil hotový <code>build/bundle.js</code> za webpack-dev-server <code>&lt;script src=&quot;//localhost:8888/build/app.js&quot;&gt;</code>.</p>
<p><strong>Takový server může být v PHP, Pythonu, Javě či vašem oblíbeném jazyce XXX</strong>. Asi vás úplně nepřekvapí, že my šáhneme opět po JavaScriptu a to <strong>node.js</strong>. Mít prohlížečovou část, serverovou část a nástroje včetně jejich nastavení v jednom jazyce nabízí řadu výhod. Je snadné sdílet stejný kód (router, validace). Lze jednoduše přepínat mezi produkčním a vývojovým režimem. To jsou takové příjemné bonusy. <strong>Pak se nabízí ale i možnost server-side renderování Reactu, kterou už bez node.js nemáte</strong>. Tu však zatím rozebírat nebudeme.</p>
<p>Jelikož se tato série soustředí především na tu prohlížečovou část, tak se samotným nodem moc zabývat prozatím nebudeme. Ostatně existuje už i <a href="http://www.zdrojak.cz/clanky/javascript-na-serveru-zaciname-s-node-js/">český node.js seriál</a>, i když už trochu zastaralý.</p>
<p>Hlavní soubor serveru <code>index.js</code> vypadá takto:</p>
<code class="codeBlock"><span class="token function" >require<span class="token punctuation" >(</span></span><span class="token string" >'babel/register'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token function" >require<span class="token punctuation" >(</span></span><span class="token string" >'./main'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span></code><p>Pokud chceme používat Babel v prohlížeči, musíme nejdříve náš kód prohnat Babel kompilátorem a prohlížeči poslat až výsledný JavaScript. V prostředí node.js můžeme udělat to samé. Nicméně díky tomu, že nemusíme řešit spojování modulů, minimalizaci a prohlížeče, tak existují i další možnosti. Například <strong>lze místo node používat <a href="https://babeljs.io/docs/usage/cli/#babel-node">babel-node</a></strong>. Pro spuštění serveru pak použijete příkaz <code>babel-node index</code> místo <code>node index</code>. Další a <strong>elegantní možností je výše použitý <a href="https://babeljs.io/docs/usage/require/">require hook</a> <code>require(&#39;babel/register&#39;)</code></strong>. Babel se nabinduje na nodí require a bude kompilovat soubory za běhu (počínaje <code>./main.js</code>). Šestá verze node.js je už téměř plně kompatibilní s ES2015. Bohužel pořád chybí podpora ES2015 modulů a tak je stále Babel ještě potřeba. Nimcéně stačí použít minimalistický <code>babel-preset-node6</code>. Pokud chcete použít starší verzi Node, je potřeba příslušný preset, který doplňuje více chybějících funkcí.</p>
<p>Soubor <code>main.js</code> je už zajímavější:</p>
<code class="codeBlock">
<span class="token keyword" >import</span> <span class="token qualifier" >React</span> from <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token qualifier" >React</span>DOMServer from <span class="token string" >'react-dom/server'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> express from <span class="token string" >'express'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> compression from <span class="token string" >'compression'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token qualifier" >Html</span> from <span class="token string" >'./html'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> app <span class="token operator" >=</span> <span class="token function" >express<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> port <span class="token operator" >=</span> process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>PORT <span class="token operator" >||</span> <span class="token number" >8000</span><span class="token punctuation" >;</span>

app<span class="token punctuation" >.</span><span class="token function" >use<span class="token punctuation" >(</span></span><span class="token function" >compression<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
app<span class="token punctuation" >.</span><span class="token function" >use<span class="token punctuation" >(</span></span><span class="token string" >'/build'</span><span class="token punctuation" >,</span> express<span class="token punctuation" >.</span><span class="token function" >static<span class="token punctuation" >(</span></span><span class="token string" >'build'</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

app<span class="token punctuation" >.</span><span class="token function" >get<span class="token punctuation" >(</span></span><span class="token string" >'*'</span><span class="token punctuation" >,</span> <span class="token punctuation" >(</span>req<span class="token punctuation" >,</span> res<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  res<span class="token punctuation" >.</span><span class="token function" >send<span class="token punctuation" >(</span></span>`<span class="token operator" >&lt;</span><span class="token operator" >!</span>DOCTYPE html<span class="token operator" >></span>$<span class="token punctuation" >{</span><span class="token qualifier" >React</span>DOMServer<span class="token punctuation" >.</span><span class="token function" >renderToStaticMarkup<span class="token punctuation" >(</span></span><span class="token operator" >&lt;</span><span class="token qualifier" >Html</span> <span class="token operator" >/</span><span class="token operator" >></span><span class="token punctuation" >)</span><span class="token punctuation" >}</span>`<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

app<span class="token punctuation" >.</span><span class="token function" >listen<span class="token punctuation" >(</span></span>port<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
console<span class="token punctuation" >.</span><span class="token function" >log<span class="token punctuation" >(</span></span>`<span class="token qualifier" >Server</span> started on port $<span class="token punctuation" >{</span>port<span class="token punctuation" >}</span>`<span class="token punctuation" >)</span><span class="token punctuation" >;</span> <span class="token comment" spellcheck="true">// eslint-disable-line</span></code><p><strong>Představuje totiž celý server</strong>. Nepotřebujeme už Apache či Nginx, protože node umí obstarat HTTP komunikaci sám. Express je nejpoužívanější node framework, se kterým je hračka napsat například jakékoliv API.</p>
<p><strong>Nám stačí pouze jedno pravidlo</strong>. V metodě <code>app.get</code> říkáme, že na jakoukoliv adresu nám má server poslat daný řetězec, který reprezentuje naší prázdnou HTML stránku. Tedy krom adresáře <code>/build</code>, ve kterém budeme mít naše JS/CSS bundly či obrázky.</p>
<p>Trošku jsem v úvodu lhal o té jediné React komponentě. Tady je totiž druhá s názvem <code>Html</code>. <strong><code>ReactDOMServer.renderToStaticMarkup</code> vrátí DOM v podobě prostého řetězce</strong>.</p>
<p>Poslední dílek skládanky je samotná struktura stránky v Reactu <code>html.js</code>:</p>
<code class="codeBlock"><span class="token keyword" >import</span> <span class="token qualifier" >React</span> from <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> path from <span class="token string" >'path'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> fs from <span class="token string" >'fs'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> isProduction <span class="token operator" >=</span> process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>NODE_ENV <span class="token operator" >===</span> <span class="token string" >'production'</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> buildDir <span class="token operator" >=</span> isProduction <span class="token operator" >?</span> fs<span class="token punctuation" >.</span><span class="token function" >readdirSync<span class="token punctuation" >(</span></span>path<span class="token punctuation" >.</span><span class="token function" >resolve<span class="token punctuation" >(</span></span>__dirname<span class="token punctuation" >,</span> <span class="token string" >'../../build'</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span> <span class="token punctuation" >:</span> <span class="token string" >''</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> appJS <span class="token operator" >=</span> isProduction <span class="token operator" >?</span> buildDir<span class="token punctuation" >.</span><span class="token function" >find<span class="token punctuation" >(</span></span>file <span class="token operator" >=</span><span class="token operator" >></span> <span class="token regex" >/^app\-\w+\.js$/</span><span class="token punctuation" >.</span><span class="token function" >test<span class="token punctuation" >(</span></span>file<span class="token punctuation" >)</span><span class="token punctuation" >)</span> <span class="token punctuation" >:</span> <span class="token string" >''</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> appCSS <span class="token operator" >=</span> isProduction <span class="token operator" >?</span> buildDir<span class="token punctuation" >.</span><span class="token function" >find<span class="token punctuation" >(</span></span>file <span class="token operator" >=</span><span class="token operator" >></span> <span class="token regex" >/^app\-\w+\.css$/</span><span class="token punctuation" >.</span><span class="token function" >test<span class="token punctuation" >(</span></span>file<span class="token punctuation" >)</span><span class="token punctuation" >)</span> <span class="token punctuation" >:</span> <span class="token string" >''</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> scripts <span class="token operator" >=</span> isProduction <span class="token operator" >?</span> `<span class="token operator" >/</span>build<span class="token operator" >/</span>$<span class="token punctuation" >{</span>appJS<span class="token punctuation" >}</span>` <span class="token punctuation" >:</span> '<span class="token comment" spellcheck="true">//localhost:8080/build/app.js';
</span>
<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token operator" >&lt;</span>html<span class="token operator" >></span>
  <span class="token operator" >&lt;</span>head<span class="token operator" >></span>
    <span class="token operator" >&lt;</span>meta charSet<span class="token operator" >=</span><span class="token string" >"utf-8"</span> <span class="token operator" >/</span><span class="token operator" >></span>
    <span class="token operator" >&lt;</span>title<span class="token operator" >></span><span class="token qualifier" >First</span> dev<span class="token operator" >-</span>stack<span class="token operator" >&lt;</span><span class="token operator" >/</span>title<span class="token operator" >></span>
    <span class="token punctuation" >{</span>isProduction <span class="token operator" >&amp;&amp;</span> <span class="token operator" >&lt;</span>link href<span class="token operator" >=</span><span class="token punctuation" >{</span>`<span class="token operator" >/</span>build<span class="token operator" >/</span>$<span class="token punctuation" >{</span>appCSS<span class="token punctuation" >}</span>`<span class="token punctuation" >}</span> rel<span class="token operator" >=</span><span class="token string" >"stylesheet"</span> <span class="token operator" >/</span><span class="token operator" >></span><span class="token punctuation" >}</span>
  <span class="token operator" >&lt;</span><span class="token operator" >/</span>head<span class="token operator" >></span>
  <span class="token operator" >&lt;</span>body<span class="token operator" >></span>
    <span class="token operator" >&lt;</span>div id<span class="token operator" >=</span><span class="token string" >"app-root"</span> <span class="token operator" >/</span><span class="token operator" >></span>
    <span class="token operator" >&lt;</span>script src<span class="token operator" >=</span><span class="token punctuation" >{</span>scripts<span class="token punctuation" >}</span> type<span class="token operator" >=</span><span class="token string" >"text/javascript"</span> <span class="token operator" >/</span><span class="token operator" >></span>
  <span class="token operator" >&lt;</span><span class="token operator" >/</span>body<span class="token operator" >></span>
<span class="token operator" >&lt;</span><span class="token operator" >/</span>html<span class="token operator" >></span><span class="token punctuation" >;</span></code><p><strong>React si více popíšeme až v dalším článku</strong>. Zde jen uvedu, že musíme rozlišovat mezi vývojovým a produkčním režimem. Ve vývojovém nevkládáme CSS soubor pomocí <code>&lt;link&gt;</code>, ale děje se tak javascriptovou cestou, aby nám mj. fungoval hot reload pro styly. JavaScript se pak načítá z webpack serveru a adresy <code>localhost:8080/build/app.js</code>.</p>
<p>V produkčním režimu se pak klasicky servíruje CSS i JS ze stejného serveru, adresáře <code>build</code>. Název souborů se náhodně mění s každým buildem kvůli cacheování. Musíme tedy nejdříve prohledat adresář <code>build</code> a soubory najít.</p>
<p>Zbytek je jen prázdná HTML struktura (React komponenta definovaná jako funkce) a <code>div</code> s <code>id=&quot;app-root&quot;</code>, do kterého v prohlížeči vyrendrujeme naši React aplikaci. <strong>Nikdy jí nerendrujte přímo do <code>body</code> elementu, jelikož do něj rádi svévolně šahají i různé další knihovny, což pak způsobuje Reactu značný bolehlav</strong>.</p>
<p>Server si nyní můžete pustit příkazem:</p>
<code class="codeBlock">node index</code><p>V produkčním režimu pak jako:</p>
<code class="codeBlock">NODE_ENV<span class="token operator" >=</span>production node index</code><p>Případně v <code>package.json</code> máme script (alias), který lze spustit jako:</p>
<code class="codeBlock">npm run server</code><p>Nyní si otevřte Chrome a mrkněte na <code>http://localhost:8000</code>. Měli byste tam nalézt velké bíle nic - právě to jsme si totiž zatím vytvořili. Zda jde o dobré nic, zkontrolujte nahlédnutím do zdrojového kódu stránky.</p>
<h2>Front-end<a id="front-end">&nbsp;</a></h2><p>Naše dnešní aplikace bude triviální. Vytvoříme si jedinou React komponentu, která nám vypíše &quot;Hello world!&quot;. Také do ní přidáme pár obrázků a styly, abychom si ukázali, jak funguje Webpack. Vstupní bod aplikace index.js vypadá takto:</p>
<code class="codeBlock"><span class="token keyword" >import</span> <span class="token qualifier" >React</span> from <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token qualifier" >React</span>DOM from <span class="token string" >'react-dom'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token qualifier" >Main</span> from <span class="token string" >'./main'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> rootEl <span class="token operator" >=</span> document<span class="token punctuation" >.</span><span class="token function" >getElementById<span class="token punctuation" >(</span></span><span class="token string" >'app-root'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token qualifier" >React</span>DOM<span class="token punctuation" >.</span><span class="token function" >render<span class="token punctuation" >(</span></span><span class="token operator" >&lt;</span><span class="token qualifier" >Main</span> <span class="token operator" >/</span><span class="token operator" >></span><span class="token punctuation" >,</span> rootEl<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token block-keyword" >if</span> <span class="token punctuation" >(</span>module<span class="token punctuation" >.</span>hot<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  module<span class="token punctuation" >.</span>hot<span class="token punctuation" >.</span><span class="token function" >accept<span class="token punctuation" >(</span></span><span class="token string" >'./main'</span><span class="token punctuation" >,</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> <span class="token qualifier" >Next</span><span class="token qualifier" >App</span> <span class="token operator" >=</span> <span class="token function" >require<span class="token punctuation" >(</span></span><span class="token string" >'./main'</span><span class="token punctuation" >)</span><span class="token punctuation" >.</span><span class="token keyword" >default</span><span class="token punctuation" >;</span> <span class="token comment" spellcheck="true">// eslint-disable-line
</span>    <span class="token qualifier" >React</span>DOM<span class="token punctuation" >.</span><span class="token function" >render<span class="token punctuation" >(</span></span><span class="token operator" >&lt;</span><span class="token qualifier" >Next</span><span class="token qualifier" >App</span> <span class="token operator" >/</span><span class="token operator" >></span><span class="token punctuation" >,</span> rootEl<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span></code><p>V DOMu si vylovíme div, do kterého pak vyrendrujeme naši jedinou hlavní komponentu <code>Main</code>. Děsí vás ty špičaté závorky? Říkáte si, že to není validní JS syntax? Ano, není. <strong>Nicméně Babel dané syntaxi rozumí (JSX) a překládá jí do normálních JS funkcí</strong>. Jediné co musíte pro použití JSX udělat je import Reactu.</p>
<p>Část s <code>module.hot</code> je pro účely vývojového režimu. Říkáme zde webpacku, že umíme přijmout změny (hot reload), pokud se něco změní v souboru <code>./main</code> či jeho potomcích. Pokud se něco změní, jednoduše znova vyrendrujeme celou aplikaci.</p>
<p>Samotná <code>Main</code> komponenta není o moc složitější:</p>
<code class="codeBlock"><span class="token keyword" >import</span> <span class="token qualifier" >React</span> from <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> imgHello from <span class="token string" >'./hello.gif'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> imgIcon from <span class="token string" >'./icon.png'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token string" >'./main.less'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token operator" >&lt;</span>div className<span class="token operator" >=</span><span class="token string" >"hello"</span><span class="token operator" >></span>
  <span class="token qualifier" >Hello</span> world<span class="token operator" >!</span>
  <span class="token operator" >&lt;</span>img src<span class="token operator" >=</span><span class="token punctuation" >{</span>imgHello<span class="token punctuation" >}</span> width<span class="token operator" >=</span><span class="token string" >"300px"</span> alt<span class="token operator" >=</span><span class="token string" >"hello world"</span> <span class="token operator" >/</span><span class="token operator" >></span>
  <span class="token operator" >&lt;</span>img src<span class="token operator" >=</span><span class="token punctuation" >{</span>imgIcon<span class="token punctuation" >}</span> role<span class="token operator" >=</span><span class="token string" >"presentation"</span> <span class="token operator" >/</span><span class="token operator" >></span>
<span class="token operator" >&lt;</span><span class="token operator" >/</span>div<span class="token operator" >></span><span class="token punctuation" >;</span></code><p>Povšimněte si, že kromě povinného Reactu <strong>importujeme i soubor s LESS</strong> (stylopis pro naši komponentu s className hello) <strong>a dokonce i obrázky</strong>. Potřeba minimalizace a mazání nepoužívaných CSS je asi všem jasná. <strong>Proč se ale zaobírat obrázky, když ty se nahrávají asynchronně a jen když jsou potřeba i bez nějakého webpacku?</strong></p>
<ul>
<li>Obrázky menší než např. 10kB můžeme automaticky <strong>enkódovat do base64</strong> a vložit přímo do HTML. Tím ušetříme zbytečný HTTP request.</li>
<li><strong>Pojmenování</strong>. Webpack obrázky přejmenuje na jejich hash a přesune do společného <code>/build</code> adresáře. Prohlížeč je tak může cacheovat &quot;navždy&quot;, pokud se změní, tak se změní i jejich název.</li>
<li><strong>Lepší struktura a opravdová modularita</strong>. Obrázky totiž můžeme mít přímo u jednotlivých komponent, aniž bychom veřejně odhalovali strukturu naší aplikace. Stejně jako styly a vše ostatní.</li>
</ul>
<p>Pokud se vám nelíbí představa, že byste museli všechny obrázky uvádět přes import, nezoufejte. Webpack umí poznat a vytáhnout název importu i přímo ze <code>src=&quot;&quot;</code>, když si to nastavíte pomocí <a href="http://webpack.github.io/docs/loaders.html#query">loader query</a>.</p>
<p>Pro úplnou přehlednost ještě uvedu obsah souboru <code>main.less</code>:</p>
<code class="codeBlock"><span class="token punctuation" >.</span>hello <span class="token punctuation" >{</span>
  color<span class="token punctuation" >:</span> #ff0000<span class="token punctuation" >;</span>
  font<span class="token operator" >-</span>size<span class="token punctuation" >:</span> 3em<span class="token punctuation" >;</span>

  img <span class="token punctuation" >{</span>
    display<span class="token punctuation" >:</span> block<span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span></code><h2>NPM scripts<a id="npm-scripts">&nbsp;</a></h2><p>V <code>package.json</code> si zadefinujeme jednoduché skripty pomocí kterých budeme spouštět build, linter a vývojový režim. Nejdříve ale ještě musíme doplnit webpack konfiguraci, než budou skripty níže funkční.</p>
<code class="codeBlock"><span class="token string" >"clean"</span><span class="token punctuation" >:</span> <span class="token string" >"rm -rf build"</span><span class="token punctuation" >,</span>
<span class="token string" >"start"</span><span class="token punctuation" >:</span> <span class="token string" >"node webpack/index | NODE_ENV=development node src/server"</span><span class="token punctuation" >,</span>
<span class="token string" >"build"</span><span class="token punctuation" >:</span> <span class="token string" >"npm run clean &amp;&amp; NODE_ENV=production webpack --config webpack/config.prod.babel.js"</span><span class="token punctuation" >,</span>
<span class="token string" >"server"</span><span class="token punctuation" >:</span> <span class="token string" >"NODE_ENV=production node src/server"</span><span class="token punctuation" >,</span>
<span class="token string" >"lint"</span><span class="token punctuation" >:</span> <span class="token string" >"eslint src webpack || true"</span></code><p>Vývojový režim spustíme pomocí příkazů:</p>
<code class="codeBlock">npm start
open http<span class="token punctuation" >:</span><span class="token operator" >/</span><span class="token operator" >/</span>localhost<span class="token punctuation" >:</span><span class="token number" >8000</span></code><p>Aplikaci vybuildíme a spustíme takto:</p>
<code class="codeBlock">npm run build
npm run server
open http<span class="token punctuation" >:</span><span class="token operator" >/</span><span class="token operator" >/</span>localhost<span class="token punctuation" >:</span><span class="token number" >8000</span></code><p>Linter:</p>
<code class="codeBlock">npm run lint</code><p>Je už na vás, kdy budete linter spouštět v rámci vašeho procesu. Doporučuji si lintování také nainstalovat do vašeho textového editoru, abyste o chybách věděli ihned a gulp task mít jen jako takovou pojistku. Podporovány jsou <a href="http://eslint.org/docs/user-guide/integrations">všechny běžné editory</a>.</p>
<h2>Nastavení Webpacku (vývojový režim)<a id="nastaven-webpacku-v-vojov-re-im-">&nbsp;</a></h2><p>To nejlepší nakonec. <strong>Dnešní příběh završíme nastavením Webpacku, který naší aplikaci vdechne život</strong>. Vývojový režim se zapíná pomocí <code>npm start</code> alias <code>node webpack/index | NODE_ENV=development node src/server</code>. Tímto se zároveň spustí webpack dev server (ukážeme si níže) a také náš hlavní server (viz výše).</p>
<p>Webpack dev server nám bude průběžně servírovat JavaScript a styly pomocí websocketů a hot reloadingu. <code>webpack/index</code> je opět pouze babel require hook abychom měli plnou podporu ES2015:</p>
<code class="codeBlock"><span class="token function" >require<span class="token punctuation" >(</span></span><span class="token string" >'babel-register'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token function" >require<span class="token punctuation" >(</span></span><span class="token string" >'./server.dev'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span></code><p>Samotný webpack dev server je v <code>server.dev.js</code>:</p>
<code class="codeBlock"><span class="token keyword" >import</span> express from <span class="token string" >'express'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> webpack from <span class="token string" >'webpack'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> webpackDev from <span class="token string" >'webpack-dev-middleware'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> webpackHot from <span class="token string" >'webpack-hot-middleware'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> configDev from <span class="token string" >'./config.dev.babel'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> app <span class="token operator" >=</span> <span class="token function" >express<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> compiler <span class="token operator" >=</span> <span class="token function" >webpack<span class="token punctuation" >(</span></span>configDev<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

app<span class="token punctuation" >.</span><span class="token function" >use<span class="token punctuation" >(</span></span><span class="token function" >webpackDev<span class="token punctuation" >(</span></span>compiler<span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
  publicPath<span class="token punctuation" >:</span> configDev<span class="token punctuation" >.</span>output<span class="token punctuation" >.</span>publicPath<span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

app<span class="token punctuation" >.</span><span class="token function" >use<span class="token punctuation" >(</span></span><span class="token function" >webpackHot<span class="token punctuation" >(</span></span>compiler<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

app<span class="token punctuation" >.</span><span class="token function" >listen<span class="token punctuation" >(</span></span>configDev<span class="token punctuation" >.</span>hotPort<span class="token punctuation" >,</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  console<span class="token punctuation" >.</span><span class="token function" >log<span class="token punctuation" >(</span></span><span class="token string" >'Dev server started at port %d'</span><span class="token punctuation" >,</span> configDev<span class="token punctuation" >.</span>hotPort<span class="token punctuation" >)</span><span class="token punctuation" >;</span> <span class="token comment" spellcheck="true">// eslint-disable-line
</span><span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span></code><p>Opět použijeme express. Webpack dev server s hot reloading přidáme jako middleware našeho express serveru. Webpack pak příjímá prvním parametrem konfiguraci, což je jeden velký JS object. V našem případě jde o vývojový konfig <code>config.dev.babel.js</code>:</p>
<code class="codeBlock"><span class="token keyword" >import</span> webpack from <span class="token string" >'webpack'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> path from <span class="token string" >'path'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> ip from <span class="token string" >'ip'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token punctuation" >{</span> HOT_RELOAD_PORT<span class="token punctuation" >,</span> SRC_DIR<span class="token punctuation" >,</span> BUILD_DIR <span class="token punctuation" >}</span> from <span class="token string" >'./constants'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >{</span>
  hotPort<span class="token punctuation" >:</span> HOT_RELOAD_PORT<span class="token punctuation" >,</span>
  cache<span class="token punctuation" >:</span> <span class="token primitive" >true</span><span class="token punctuation" >,</span>
  debug<span class="token punctuation" >:</span> <span class="token primitive" >true</span><span class="token punctuation" >,</span>
  devtool<span class="token punctuation" >:</span> <span class="token string" >'source-map'</span><span class="token punctuation" >,</span>
  entry<span class="token punctuation" >:</span> <span class="token punctuation" >{</span> app<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    `webpack<span class="token operator" >-</span>hot<span class="token operator" >-</span>middleware<span class="token operator" >/</span>client<span class="token operator" >?</span>path<span class="token operator" >=</span>http<span class="token punctuation" >:</span><span class="token operator" >/</span><span class="token operator" >/</span>$<span class="token punctuation" >{</span>ip<span class="token punctuation" >.</span><span class="token function" >address<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >}</span><span class="token punctuation" >:</span>$<span class="token punctuation" >{</span>HOT_RELOAD_PORT<span class="token punctuation" >}</span><span class="token operator" >/</span>__webpack_hmr`<span class="token punctuation" >,</span>
    path<span class="token punctuation" >.</span><span class="token function" >join<span class="token punctuation" >(</span></span>SRC_DIR<span class="token punctuation" >,</span> <span class="token string" >'client/index.js'</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span> <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  module<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    loaders<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token punctuation" >{</span>
      loader<span class="token punctuation" >:</span> <span class="token string" >'url-loader?limit=10000'</span><span class="token punctuation" >,</span>
      test<span class="token punctuation" >:</span> <span class="token regex" >/\.(gif|jpg|png|woff|woff2|eot|ttf|svg|wav)$/</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
      test<span class="token punctuation" >:</span> <span class="token regex" >/\.js$/</span><span class="token punctuation" >,</span>
      exclude<span class="token punctuation" >:</span> <span class="token regex" >/node_modules/</span><span class="token punctuation" >,</span>
      loader<span class="token punctuation" >:</span> <span class="token string" >'babel'</span><span class="token punctuation" >,</span>
      query<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
        plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'transform-runtime'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
        presets<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'es2015'</span><span class="token punctuation" >,</span> <span class="token string" >'react'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
      test<span class="token punctuation" >:</span> <span class="token regex" >/\.less$/</span><span class="token punctuation" >,</span>
      loader<span class="token punctuation" >:</span> <span class="token string" >'style-loader!css-loader!less-loader'</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  output<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    path<span class="token punctuation" >:</span> BUILD_DIR<span class="token punctuation" >,</span>
    filename<span class="token punctuation" >:</span> <span class="token string" >'[name].js'</span><span class="token punctuation" >,</span>
    chunkFilename<span class="token punctuation" >:</span> <span class="token string" >'[name]-[chunkhash].js'</span><span class="token punctuation" >,</span>
    publicPath<span class="token punctuation" >:</span> `http<span class="token punctuation" >:</span><span class="token operator" >/</span><span class="token operator" >/</span>$<span class="token punctuation" >{</span>ip<span class="token punctuation" >.</span><span class="token function" >address<span class="token punctuation" >(</span></span><span class="token punctuation" >)</span><span class="token punctuation" >}</span><span class="token punctuation" >:</span>$<span class="token punctuation" >{</span>HOT_RELOAD_PORT<span class="token punctuation" >}</span><span class="token operator" >/</span>build<span class="token operator" >/</span>`<span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>DefinePlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span> <span class="token string" >'process.env'</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span> NODE_ENV<span class="token punctuation" >:</span> JSON<span class="token punctuation" >.</span><span class="token function" >stringify<span class="token punctuation" >(</span></span><span class="token string" >'development'</span><span class="token punctuation" >)</span> <span class="token punctuation" >}</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>HotModuleReplacementPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>NoErrorsPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  resolve<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    extensions<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >''</span><span class="token punctuation" >,</span> <span class="token string" >'.js'</span><span class="token punctuation" >,</span> <span class="token string" >'.json'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
    modulesDirectories<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'src'</span><span class="token punctuation" >,</span> <span class="token string" >'node_modules'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span></code><p>Ten se skládá z několika částí. Webpack agresivně <a href="http://webpack.github.io/docs/configuration.html#cache">cacheuje</a> jednotlivé moduly a chunky, což výrazně zlepšuje rychlost inkrementálních buildů. To se nám samozřejmě velmi hodí pro vývoj. <a href="http://webpack.github.io/docs/configuration.html#debug">Debug</a> nám nastaví loadery do debug režimu. <a href="http://webpack.github.io/docs/configuration.html#devtool">Devtool</a> nám nabízí možnost generovat source mapy.</p>
<p>Dale musíme přidat <code>entry</code>, kde specifikujeme vstupní soubory naší aplikace aneb místo, kde webpack začne rozmotávat všechny závislosti.</p>
<p>Následně musíme zaregistrovat loadery pro jednotlivé typy importovaných souborů. Lze si je představit jako pipes z bashe. Dostanou obsah souboru, provedou nějakou transformaci a pošlou ji na výstup. <strong>Ovšem pozor, zpracovávají se zprava do leva</strong>. <code>Loaders</code> nebo <code>loader</code> specifikuje, který loader pro dané pravidlo použít. <code>Test</code> je regexp, který určí z názvu importu (typicky přípony), zda se má daný loader použít. Pomocí <code>exclude</code> je pak možné vyloučit některé importy, což se hodí pro <code>/node_modules</code>.</p>
<p><strong>První loader nám zpracovává obrázky</strong>. Pokud jsou menší než 10kB, tak je převede do base64. Vrátí pak URL adresu obrázku. <strong>Druhý loader se aplikuje na všechny JavaScriptové soubory</strong>. Prožene je babel transformací. <strong>Poslední loader pak zpracovává LESS importy</strong>.</p>
<p>Webpack nyní ví co zpracovávat a pomocí jakých loaderů (transformací). <strong>Nyní mu ještě zbývá říct, jak má vypadat výstup</strong> v direktivě <code>output</code>. <strong>Naše aplikace je jednoduchá a proto nám stačí jeden výstupní společný bundle</strong>. Skripty a styly nám bude servírovat přímo webpack-dev-server, který poběží na adrese v <code>publicPath</code>.</p>
<p>Dále můžeme ještě v konfiguraci specifikovat <strong>pluginy, které dělají další úpravy a optimalizace společné pro všechny moduly</strong>. V prohlížeči nemáme dostupnou proměnnou <code>process.env.NODE_ENV</code> a přesto by se nám tam občas hodilo rozlišit v jakém jsme módu. Není nic jednoduššího, než si jí <strong>hromadně nahradit webpackem</strong>. Aby nám fungoval hot-reload, musíme aplikovat <code>webpack.HotModuleReplacementPlugin</code>.</p>
<p>Nakonec ještě řekneme webpacku, které defaultní přípony (typy souborů) má umět importovat i bez toho aniž bychom uvedli koncovku.</p>
<h2>Nastavení Webpacku (produkční režim)<a id="nastaven-webpacku-produk-n-re-im-">&nbsp;</a></h2><p>Pro produkční režim nepotřebujeme server či hot reloading, jelikož se build proces volá jednorázově příkazem</p>
<code class="codeBlock">npm run build</code><p>Ten nedělá nic jiného než to, že zavolá webpack a předá mu produkční verzi konfigurace <code>config.prod.babel.js</code>. Ten je strukturou velmi podobný tomu vývojovému:</p>
<code class="codeBlock"><span class="token keyword" >import</span> <span class="token qualifier" >Extract</span><span class="token qualifier" >Text</span><span class="token qualifier" >Plugin</span> from <span class="token string" >'extract-text-webpack-plugin'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> path from <span class="token string" >'path'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> webpack from <span class="token string" >'webpack'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token punctuation" >{</span> HOT_RELOAD_PORT<span class="token punctuation" >,</span> SRC_DIR<span class="token punctuation" >,</span> BUILD_DIR <span class="token punctuation" >}</span> from <span class="token string" >'./constants'</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> <span class="token punctuation" >{</span>
  cache<span class="token punctuation" >:</span> <span class="token primitive" >false</span><span class="token punctuation" >,</span>
  debug<span class="token punctuation" >:</span> <span class="token primitive" >false</span><span class="token punctuation" >,</span>
  entry<span class="token punctuation" >:</span> <span class="token punctuation" >{</span> app<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>path<span class="token punctuation" >.</span><span class="token function" >join<span class="token punctuation" >(</span></span>SRC_DIR<span class="token punctuation" >,</span> <span class="token string" >'client/index.js'</span><span class="token punctuation" >)</span><span class="token punctuation" >]</span> <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  module<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    loaders<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token punctuation" >{</span>
      loader<span class="token punctuation" >:</span> <span class="token string" >'url-loader?limit=10000'</span><span class="token punctuation" >,</span>
      test<span class="token punctuation" >:</span> <span class="token regex" >/\.(gif|jpg|png|woff|woff2|eot|ttf|svg|wav)$/</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
      test<span class="token punctuation" >:</span> <span class="token regex" >/\.js$/</span><span class="token punctuation" >,</span>
      exclude<span class="token punctuation" >:</span> <span class="token regex" >/node_modules/</span><span class="token punctuation" >,</span>
      loader<span class="token punctuation" >:</span> <span class="token string" >'babel'</span><span class="token punctuation" >,</span>
      query<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
        plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'transform-runtime'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
        presets<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'es2015'</span><span class="token punctuation" >,</span> <span class="token string" >'react'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
      test<span class="token punctuation" >:</span> <span class="token regex" >/\.less$/</span><span class="token punctuation" >,</span>
      loader<span class="token punctuation" >:</span> <span class="token qualifier" >Extract</span><span class="token qualifier" >Text</span><span class="token qualifier" >Plugin</span><span class="token punctuation" >.</span><span class="token function" >extract<span class="token punctuation" >(</span></span><span class="token string" >'style-loader'</span><span class="token punctuation" >,</span> <span class="token string" >'css-loader!less-loader'</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  output<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    path<span class="token punctuation" >:</span> BUILD_DIR<span class="token punctuation" >,</span>
    publicPath<span class="token punctuation" >:</span> <span class="token string" >'/build/'</span><span class="token punctuation" >,</span>
    filename<span class="token punctuation" >:</span> <span class="token string" >'[name]-[hash].js'</span><span class="token punctuation" >,</span>
    chunkFilename<span class="token punctuation" >:</span> <span class="token string" >'[name]-[chunkhash].js'</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>DefinePlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span> <span class="token string" >'process.env'</span><span class="token punctuation" >:</span> <span class="token punctuation" >{</span> NODE_ENV<span class="token punctuation" >:</span> JSON<span class="token punctuation" >.</span><span class="token function" >stringify<span class="token punctuation" >(</span></span><span class="token string" >'production'</span><span class="token punctuation" >)</span> <span class="token punctuation" >}</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token keyword" >new</span> <span class="token class-name" >ExtractTextPlugin</span><span class="token punctuation" >(</span><span class="token string" >'app-[hash].css'</span><span class="token punctuation" >,</span> <span class="token punctuation" >{</span> allChunks<span class="token punctuation" >:</span> <span class="token primitive" >true</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>optimize<span class="token punctuation" >.</span>DedupePlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>optimize<span class="token punctuation" >.</span>OccurenceOrderPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>optimize<span class="token punctuation" >.</span>UglifyJsPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span> compress<span class="token punctuation" >:</span> <span class="token punctuation" >{</span> warnings<span class="token punctuation" >:</span> <span class="token primitive" >false</span> <span class="token punctuation" >}</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  resolve<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    extensions<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >''</span><span class="token punctuation" >,</span> <span class="token string" >'.js'</span><span class="token punctuation" >,</span> <span class="token string" >'.json'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
    modulesDirectories<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'src'</span><span class="token punctuation" >,</span> <span class="token string" >'node_modules'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span></code><p>Nemusíme řešit ani inkrementální cacheování či sourcemapy. Loadery jsou totožné. Výstup uložíme do adresáře build. V produkčním módu musíme specifikovat <strong>kam uložit poslepované CSS styly</strong> pomocí <code>ExtractTextPlugin</code>. Následně použijeme <code>UglifyJsPlugin</code>. Ten významně minimalizuje JavaScriptový kód a provede další optimalizace (trvá to). <code>webpack.optimize.DedupePlugin</code> a <code>OccurenceOrderPlugin</code> jsou další optimalizace webpacku, které zmenší výsledný bundle.</p>
<h2>Celý dev-stack<a id="cel-dev-stack">&nbsp;</a></h2><p><strong>A to je prakticky vše!</strong>. V souborech <code>.babelrc</code> a <code>.eslintrc</code> už zbývá nastavit pár základních věcí pro babel a ESLint (mrkněte do zdrojáků). Celý dev stack najdete v <a href="https://github.com/tajo/devstack">samostatném repozitáři na GitHubu</a>. Z terminálu se k funkčnímu stavu můžete dopracovat touto sadou příkazů (předpokládá se, že máte nainstalovaný node a npm):</p>
<code class="codeBlock">git clone git@github<span class="token punctuation" >.</span>com<span class="token punctuation" >:</span>tajo<span class="token operator" >/</span>devstack<span class="token punctuation" >.</span>git
cd devstack
npm install
npm start</code><p>Po otevření prohlížeče na adrese <code>http://localhost:8000</code> byste měli vidět to co je na úvodním gifu. Taktéž by měl fungovat hot-reload. Otevřte si konzoli. Ne vždy hot-reload funguje (u změn mimo React komponenty). <strong>V konzoli vám pak webpack napíše, že máte provést ruční reload stránky. Proč ho neděláme automaticky? Protože je to otravné.</strong> V praxi se pak stává, že si nechtíc něco uložíte, udělá se refresh a ztratí se vám stav. Prozkoumejte také tab <code>Elements</code> a mrkněte na to, jak vypadá výsledný DOM ve vývojovém a produkčním režimu.</p>
<h2>Závěrem<a id="z-v-rem">&nbsp;</a></h2><p><strong>Postavili jsme si jednoduchý, ale moderní JS devstack</strong>, který splňuje všechna očekávání vytyčená v úvodu. Nabízí nám pohodlný vývojový režim s hot-reloadem a bohatými výpisy (včetně source-map), které nám značně usnadní vývoj. V produkčním režimu nám pak webpack vytvoří maximálně optimalizovaný výstupní bundle s našimi skripty, styly a obrázky. Serverovou část naší aplikace jsme vyřešili v node.js. Základní HTML stránku si lze ale stejně dobře naservírovat i jakoukoliv jinou technologií, třeba Apachem s PHP. <strong>Příště si představíme React a konečně si něco naprogramujeme.</strong></p>
</div></div></div></div><footer data-reactid=".1bsoigh6xhc.1.0.2"><div class="links" data-reactid=".1bsoigh6xhc.1.0.2.0"><div style="float:left;" data-reactid=".1bsoigh6xhc.1.0.2.0.0"><span data-reactid=".1bsoigh6xhc.1.0.2.0.0.0">◀</span><span data-reactid=".1bsoigh6xhc.1.0.2.0.0.1"> </span><a href="nastroje.html" target="_self" data-reactid=".1bsoigh6xhc.1.0.2.0.0.2">Nástroje</a></div><div style="float:right;" data-reactid=".1bsoigh6xhc.1.0.2.0.1"><a href="react-uvod.html" target="_self" data-reactid=".1bsoigh6xhc.1.0.2.0.1.0">React - Úvod</a><span data-reactid=".1bsoigh6xhc.1.0.2.0.1.1"> </span><span data-reactid=".1bsoigh6xhc.1.0.2.0.1.2">▶</span></div></div><div class="Footer" data-reactid=".1bsoigh6xhc.1.0.2.1"><span data-reactid=".1bsoigh6xhc.1.0.2.1.0">Diskutujte prostřednictvím </span><a href="https://github.com/tajo/javascript/issues" data-reactid=".1bsoigh6xhc.1.0.2.1.1">issues</a><span data-reactid=".1bsoigh6xhc.1.0.2.1.2">.</span><br data-reactid=".1bsoigh6xhc.1.0.2.1.3"><span data-reactid=".1bsoigh6xhc.1.0.2.1.4">Vylepšete článek </span><a href="https://github.com/tajo/javascript/pulls" data-reactid=".1bsoigh6xhc.1.0.2.1.5">pull requestem</a><span data-reactid=".1bsoigh6xhc.1.0.2.1.6">.</span><br data-reactid=".1bsoigh6xhc.1.0.2.1.7"><span data-reactid=".1bsoigh6xhc.1.0.2.1.8">Sledujte na </span><a href="https://twitter.com/vmiksu" data-reactid=".1bsoigh6xhc.1.0.2.1.9">twitteru</a><span data-reactid=".1bsoigh6xhc.1.0.2.1.a">. </span><span data-reactid=".1bsoigh6xhc.1.0.2.1.b"> </span><a href="/feed.xml" data-reactid=".1bsoigh6xhc.1.0.2.1.c">RSS</a><span data-reactid=".1bsoigh6xhc.1.0.2.1.d">.</span><br data-reactid=".1bsoigh6xhc.1.0.2.1.e"><b data-reactid=".1bsoigh6xhc.1.0.2.1.f">Sdílejte!</b></div></footer></div><script data-reactid=".1bsoigh6xhc.1.1">window.INITIAL_PROPS = {"location":"prvni-dev-stack.html","devMode":false,"files":{"main.css":"main-73051c71144d61d48eff.css","main.js":"main-73051c71144d61d48eff.js"}};
</script><script src="main-73051c71144d61d48eff.js" data-reactid=".1bsoigh6xhc.1.2"></script><div data-reactid=".1bsoigh6xhc.1.3">
        <script>
          var host = "dzejes.cz";
          if ((host == window.location.host) && (window.location.protocol != "https:")) {
            window.location.protocol = "https";
          }

          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-63660429-1', 'auto');
          ga('send', 'pageview');
        </script>
      </div></body></html>